import { startSubBot } from '../lib/subbot.js';
let commandFlags = {}; 

const handler = async (m, { conn, command }) => {
  try {
    commandFlags[m.sender] = true;
    const phone = m.sender?.split('@')[0];

    if (!phone) return m.reply("โ ูู ุฃุชููู ูู ุงุณุชุฎุฑุงุฌ ุฑููู.");

    // ุฑุณุงูุฉ ุชุนูููุงุช ุงูููุฏ (8 ุฃุฑูุงู)
    const msgCode = `*๐ค LoliBot-MD ๐ค*\n\n๐ ุฑุจุท ุงูุฌูุณุฉ ุจุงุณุชุฎุฏุงู ููุฏ ุงููุงุชู\n\n*1๏ธโฃ ุงูุชุญ ุงููุงุฆูุฉ (โฎ) ูู ุงูุฒุงููุฉ ุงูุนููุง ุงููููู*\n*2๏ธโฃ ุงุฎุชุฑ: ุงูุฃุฌูุฒุฉ ุงููุฑุชุจุทุฉ*\n*3๏ธโฃ ุงุฎุชุฑ: ุฑุจุท ุจุงุณุชุฎุฏุงู ููุฏ ุงููุงุชู*\n*4๏ธโฃ ุฃุฏุฎู ุงูููุฏ ุงููููู ูู 8 ุฃุฑูุงู ุงูููุฌูุฏ ุฃุฏูุงู*\n\nโ๏ธ *ุงูููุฏ ุตุงูุญ ููุฏุฉ 60 ุซุงููุฉ ููุท!*`;

    // ุงุณุชุฏุนุงุก ุฑุจุท SubBot ูุน ุฎูุงุฑ ุงูููุฏ ููุท
    await startSubBot(m, conn, msgCode, true, phone, m.chat, commandFlags);

    // ุจุนุฏ ูุฌุงุญ ุงูุฑุจุท
    setTimeout(() => {
      m.reply("โ *ุชู ุฑุจุท ุงูุฌูุณุฉ ุจูุฌุงุญ.*\nุงูุขู ููููู ุงุณุชุฎุฏุงู ุญุณุงุจู ูู SubBot ุจุฏูู ูุดุงูู ๐");
    }, 5000); // ูุฑุณู ุฑุณุงูุฉ ุงููุฌุงุญ ุจุนุฏ 5 ุซูุงูู (ูููู ุชุบูุฑูุง)

  } catch (err) {
    console.error(`โ ุฎุทุฃ ุฃุซูุงุก ูุญุงููุฉ ุชุดุบูู SubBot:`, err);
    await m.reply("โ๏ธ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ูุญุงููุฉ ุชุดุบูู ุงูุฌูุณุฉ.");
  }
};

handler.help = ['ุชูุตูุจ'];
handler.tags = ['jadibot'];
handler.command = /^(ุชูุตูุจ)$/i; // ุงูุฃูุฑ ุญุตุฑู "ุชูุตูุจ"
handler.register = false;

export default handler;
